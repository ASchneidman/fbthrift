
/**
 * Autogenerated by Thrift
 *
 * DO NOT EDIT
 *  @generated
 *
 */

#include <folly/python/import.h>
#include <thrift/lib/python/capi/iobuf.h>

#include <thrift/compiler/test/fixtures/basic-python-capi/src/gen-python/module/thrift_types_api.h>
#include <thrift/compiler/test/fixtures/basic-python-capi/src/gen-python/module/thrift_types_capi.h>

namespace apache {
namespace thrift {
namespace python {
namespace capi {
namespace {
bool ensure_module_imported() {
  static ::folly::python::import_cache_nocapture import((
      ::import_test__fixtures__basic_python_capi__module__thrift_types_capi));
  return import();
}
} // namespace

ExtractorResult<::test::fixtures::basic-python-capi::MyStruct>
Extractor<::test::fixtures::basic-python-capi::MyStruct>::operator()(PyObject* obj) {
  if (!ensure_module_imported()) {
    DCHECK(PyErr_Occurred() != nullptr);
    return extractorError<::test::fixtures::basic-python-capi::MyStruct>(
      "Module test.fixtures.basic-python-capi.module import error");
  }
  std::unique_ptr<folly::IOBuf> val(
      extract__test__fixtures__basic_python_capi__module__MyStruct(obj));
  if (!val) {
    CHECK(PyErr_Occurred());
    return extractorError<::test::fixtures::basic-python-capi::MyStruct>(
        "Thrift serialize error: MyStruct");
  }
  return detail::deserialize_iobuf<::test::fixtures::basic-python-capi::MyStruct>(std::move(val));
}

int Extractor<::test::fixtures::basic-python-capi::MyStruct>::typeCheck(PyObject* obj) {
  if (!ensure_module_imported()) {
    ::folly::python::handlePythonError(
      "Module test.fixtures.basic-python-capi.module import error");
  }
  int result =
      can_extract__test__fixtures__basic_python_capi__module__MyStruct(obj);
  if (result < 0) {
    ::folly::python::handlePythonError(
      "Unexpected type check error: MyStruct");
  }
  return result;
}


PyObject* Constructor<::test::fixtures::basic-python-capi::MyStruct>::operator()(
    ::test::fixtures::basic-python-capi::MyStruct&& val) {
  if (!ensure_module_imported()) {
    DCHECK(PyErr_Occurred() != nullptr);
    return nullptr;
  }
  auto ptr = construct__test__fixtures__basic_python_capi__module__MyStruct(
      detail::serialize_to_iobuf(std::move(val)));
  if (!ptr) {
    CHECK(PyErr_Occurred());
  }
  return ptr;
}

ExtractorResult<::test::fixtures::basic-python-capi::MyDataItem>
Extractor<::test::fixtures::basic-python-capi::MyDataItem>::operator()(PyObject* obj) {
  if (!ensure_module_imported()) {
    DCHECK(PyErr_Occurred() != nullptr);
    return extractorError<::test::fixtures::basic-python-capi::MyDataItem>(
      "Module test.fixtures.basic-python-capi.module import error");
  }
  std::unique_ptr<folly::IOBuf> val(
      extract__test__fixtures__basic_python_capi__module__MyDataItem(obj));
  if (!val) {
    CHECK(PyErr_Occurred());
    return extractorError<::test::fixtures::basic-python-capi::MyDataItem>(
        "Thrift serialize error: MyDataItem");
  }
  return detail::deserialize_iobuf<::test::fixtures::basic-python-capi::MyDataItem>(std::move(val));
}

int Extractor<::test::fixtures::basic-python-capi::MyDataItem>::typeCheck(PyObject* obj) {
  if (!ensure_module_imported()) {
    ::folly::python::handlePythonError(
      "Module test.fixtures.basic-python-capi.module import error");
  }
  int result =
      can_extract__test__fixtures__basic_python_capi__module__MyDataItem(obj);
  if (result < 0) {
    ::folly::python::handlePythonError(
      "Unexpected type check error: MyDataItem");
  }
  return result;
}


PyObject* Constructor<::test::fixtures::basic-python-capi::MyDataItem>::operator()(
    ::test::fixtures::basic-python-capi::MyDataItem&& val) {
  if (!ensure_module_imported()) {
    DCHECK(PyErr_Occurred() != nullptr);
    return nullptr;
  }
  auto ptr = construct__test__fixtures__basic_python_capi__module__MyDataItem(
      detail::serialize_to_iobuf(std::move(val)));
  if (!ptr) {
    CHECK(PyErr_Occurred());
  }
  return ptr;
}

ExtractorResult<::test::fixtures::basic-python-capi::MyUnion>
Extractor<::test::fixtures::basic-python-capi::MyUnion>::operator()(PyObject* obj) {
  if (!ensure_module_imported()) {
    DCHECK(PyErr_Occurred() != nullptr);
    return extractorError<::test::fixtures::basic-python-capi::MyUnion>(
      "Module test.fixtures.basic-python-capi.module import error");
  }
  std::unique_ptr<folly::IOBuf> val(
      extract__test__fixtures__basic_python_capi__module__MyUnion(obj));
  if (!val) {
    CHECK(PyErr_Occurred());
    return extractorError<::test::fixtures::basic-python-capi::MyUnion>(
        "Thrift serialize error: MyUnion");
  }
  return detail::deserialize_iobuf<::test::fixtures::basic-python-capi::MyUnion>(std::move(val));
}

int Extractor<::test::fixtures::basic-python-capi::MyUnion>::typeCheck(PyObject* obj) {
  if (!ensure_module_imported()) {
    ::folly::python::handlePythonError(
      "Module test.fixtures.basic-python-capi.module import error");
  }
  int result =
      can_extract__test__fixtures__basic_python_capi__module__MyUnion(obj);
  if (result < 0) {
    ::folly::python::handlePythonError(
      "Unexpected type check error: MyUnion");
  }
  return result;
}


PyObject* Constructor<::test::fixtures::basic-python-capi::MyUnion>::operator()(
    ::test::fixtures::basic-python-capi::MyUnion&& val) {
  if (!ensure_module_imported()) {
    DCHECK(PyErr_Occurred() != nullptr);
    return nullptr;
  }
  auto ptr = construct__test__fixtures__basic_python_capi__module__MyUnion(
      detail::serialize_to_iobuf(std::move(val)));
  if (!ptr) {
    CHECK(PyErr_Occurred());
  }
  return ptr;
}

} // namespace capi
} // namespace python
} // namespace thrift
} // namespace apache
